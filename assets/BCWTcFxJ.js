import{u as h}from"./A34OYPRF.js";import{_ as w,r as b,o as t,c as o,a as i,t as k,y as r,C as _,q as C,l as x,F as y,z as f,D as g}from"./WBLKiZ4P.js";const T={class:"text-lg font-semibold"},B={class:"text-sm text-gray-300"},S={key:2,class:"bg-gray-500 text-white px-4 py-2 rounded",disabled:""},$={__name:"TaskItem",props:{task:Object},setup(e){const s=e,d=h(),u=b("Выполнить"),l=b(!1),m=()=>{s.task.link?(window.open(s.task.link,"_blank"),u.value="Проверить",s.task.is_completed=!0,s.task.canClaim=!1):console.error("Задание не содержит корректной ссылки.")},a=()=>{l.value=!0,setTimeout(()=>{l.value=!1,s.task.canClaim=!0},5e3)},c=async()=>{try{l.value=!0,await d.claimTaskReward(s.task.id),s.task.is_claimed=!0}catch(n){console.error("Ошибка при попытке забрать награду:",n)}finally{l.value=!1}};return(n,v)=>(t(),o("div",{class:_([{"opacity-50":e.task.is_completed&&e.task.is_claimed},"p-4 mb-4 bg-gray-800 text-white shadow rounded flex justify-between items-center"])},[i("div",null,[i("h3",T,k(e.task.title),1),i("p",B,k(e.task.reward)+" очков",1)]),i("div",null,[!e.task.is_completed&&!e.task.is_claimed?(t(),o("button",{key:0,onClick:m,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded"},k(u.value),1)):r("",!0),e.task.is_completed&&!e.task.is_claimed&&!l.value&&!e.task.canClaim?(t(),o("button",{key:1,onClick:a,class:"bg-blue-400 hover:bg-blue-700 text-white px-4 py-2 rounded"}," Проверить ")):r("",!0),l.value?(t(),o("button",S,v[0]||(v[0]=[i("div",{class:"loader"},null,-1)]))):r("",!0),e.task.is_completed&&!e.task.is_claimed&&!l.value&&e.task.canClaim?(t(),o("button",{key:3,onClick:c,class:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded"}," Забрать ")):r("",!0)])],2))}},p=w($,[["__scopeId","data-v-a665b41c"]]),I={class:"p-4 bg-gradient-to-br from-sky-500 to-indigo-500 h-screen pt-[75px] pb-[70px]"},L={class:"task h-[100%] overflow-y-scroll scrollable pt-[10px] pb-[30px]",style:{"overflow-y":"auto"}},j={key:0},z={key:1,class:"mt-8"},N={__name:"tasks",setup(e){const s=h(),d=b([]);C(async()=>{await s.fetchTasks(),d.value=s.tasks});const u=async a=>{await s.claimTaskReward(a)},l=x(()=>d.value.filter(a=>!a.is_completed||a.is_completed&&!a.is_claimed)),m=x(()=>d.value.filter(a=>a.is_completed&&a.is_claimed));return(a,c)=>(t(),o("div",I,[i("div",L,[l.value.length?(t(),o("div",j,[c[0]||(c[0]=i("h2",{class:"text-xl font-semibold text-white mb-2"},"Доступные задания",-1)),(t(!0),o(y,null,f(l.value,n=>(t(),g(p,{key:n.id,task:n,onClaim:u},null,8,["task"]))),128))])):r("",!0),m.value.length?(t(),o("div",z,[c[1]||(c[1]=i("h2",{class:"text-xl font-semibold text-white mb-2"},"Завершённые задания",-1)),(t(!0),o(y,null,f(m.value,n=>(t(),g(p,{key:n.id,task:n,onClaim:u},null,8,["task"]))),128))])):r("",!0)])]))}};export{N as default};
