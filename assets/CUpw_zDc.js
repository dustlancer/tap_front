import{u as P}from"./BT3k1xSC.js";import{_ as T,r as o,l as d,q as $,A as z,o as _,c as g,a as e,B as h,t as m,y as j,k as F,b as N}from"./-Fa4CXSO.js";const U=window.setInterval,V={class:"flex flex-col absolute top-0 w-screen z-10 items-center justify-center h-screen bg-gradient-to-b from-blue-500 to-gray-700"},E=["src"],q={class:"w-full text-center flex-col align-center absolute bottom-[15%] px-7"},A={class:"flex items-center text-4xl font-bold text-white mb-1"},R={class:"text-lg"},G={class:"h-4 bg-gray-300 rounded-full"},H={__name:"MiningCharacter",setup(y){const l=F(),s=P(),t=o(0),a=o(0),v=o(5),f=o("/ermak_bomzh-removebg-preview.png"),b=o("dirty_city_bg.png"),u=o(new Date),x=d(()=>t.value/a.value*100),w=d(()=>t.value>=a.value);let c;function k(){u.value=new Date,s.claimCoins(t.value),t.value=0,clearInterval(c),p()}function I(){const r=(new Date-u.value)/(1e3*60*60),i=Math.min(r*v.value,a.value);t.value=i,i>=a.value&&clearInterval(c)}function p(){c=U(()=>{I()},1e3)}function B(){f.value=l.public.apiBase+s.level.character_image_url,b.value=l.public.apiBase+s.level.background_image_url}const C=d(()=>({backgroundImage:`url(${b.value})`,backgroundSize:"cover",backgroundPosition:"center",filter:"grayscale(100%) contrast(400%)",mixBlendMode:"screen",opacity:.7,width:"100%",height:"100%"}));async function D(){try{const n=await fetch(`${l.public.apiBase}/api/user-storage/?user_id=${s.user_id}`);if(!n.ok)throw new Error("Ошибка загрузки данных пользователя");const r=await n.json(),{storage_capacity:i,mining_speed:S,last_claim_time:M}=r;a.value=i,v.value=S,u.value=new Date(M),p()}catch(n){console.error("Ошибка при загрузке данных: ",n)}}return $(()=>{B(),setTimeout(()=>{D()},1e3)}),z(()=>{c&&clearInterval(c)}),(n,r)=>(_(),g("div",V,[e("div",{style:h(C.value)},null,4),e("img",{src:f.value,alt:"Персонаж",class:"w-48 h-48 object-contain transition-transform duration-300 absolute"},null,8,E),e("div",q,[e("div",A,[e("div",null,[e("p",R,m(t.value.toFixed(2))+" / "+m(a.value.toFixed(2)),1)])]),e("div",G,[e("div",{class:"h-full bg-green-500 rounded-full transition-all duration-500",style:h({width:x.value+"%"})},null,4)])]),w.value?(_(),g("button",{key:0,onClick:k,class:"absolute bottom-[23%] bg-yellow-400 text-black font-bold py-2 px-4 rounded"}," Забрать "+m(t.value.toFixed(2))+" монет ",1)):j("",!0)]))}},J=T(H,[["__scopeId","data-v-11bc7bbb"]]),K={class:"bg-gray-20 overflow-hidden"},Q={__name:"index",setup(y){return(l,s)=>(_(),g("div",K,[N(J)]))}};export{Q as default};
