import{y as T,k as C,_ as I,r,l as m,q as z,o as u,c as d,a as n,z as k,v as h,t as v,A as Y,b,w as $,F as j,B as M,T as N}from"./DIdVoVMo.js";import{u as o}from"./Cxjd3_tQ.js";const F=T("clickStore",{state:()=>({localClicks:0,totalClicks:0,localCoins:o().coins}),actions:{incrementClicks(){this.localClicks+=1,this.totalClicks+=1,o().localCoins=o().coins_per_tap},async sendClicksToBackend(){if(this.localClicks>0){console.log(JSON.stringify({clicks:this.localClicks,user_id:o().user_id}));try{const c=C().public.apiBase,t=await fetch(`${c}/clicks/`,{method:"POST",body:JSON.stringify({clicks:this.localClicks,user_id:o().user_id}),headers:{"Content-Type":"application/json"}});if(t.ok){const i=await t.json();o().updateCoins(i.current_points),console.log("ok"),this.localClicks=0}else console.error("Ошибка при отправке кликов на сервер:",t.statusText)}catch(a){console.error("Ошибка при отправке кликов на сервер:",a)}}}},getters:{getTotalClicks:a=>a.totalClicks}}),L=window.setInterval,O={class:"absolute top-[15%] flex items-center text-4xl font-bold text-white mb-4"},q={class:""},A=["src"],D={__name:"MiningCharacter",setup(a){const c=C(),t=o(),i=F(),p=r("/ermak_bomzh-removebg-preview.png"),g=r("dirty_city_bg.png"),y=m(()=>t.local_coins),_=r(!1),s=r([]);function x(f){i.incrementClicks(),t.updateLocalCoins(),_.value=!0,setTimeout(()=>{_.value=!1},100);const l={id:Date.now(),points:t.coins_per_tap,top:f.clientY-50,left:f.clientX,translateY:0,opacity:1};s.value.push(l),requestAnimationFrame(()=>{const e=s.value.findIndex(B=>B.id===l.id);e!==-1&&(s.value[e].translateY=-75,s.value[e].opacity=0)}),setTimeout(()=>{s.value=s.value.filter(e=>e.id!==l.id)},1200)}const w=m(()=>({backgroundImage:`url(${g.value})`,backgroundSize:"cover",backgroundPosition:"center",filter:"grayscale(100%) contrast(400%)",mixBlendMode:"screen",opacity:.7,width:"100%",height:"100%"}));function S(){p.value=c.public.apiBase+t.level.character_image_url,g.value=c.public.apiBase+t.level.background_image_url}return z(()=>{S(),L(()=>{i.sendClicksToBackend()},5e3)}),(f,l)=>(u(),d("div",{class:"flex flex-col absolute top-0 w-screen z-10 items-center justify-center h-screen bg-gradient-to-b from-blue-500 to-gray-700",onClick:x},[n("div",{style:k(h(w))},null,4),n("div",O,[n("div",null,[n("p",q,v(h(y)),1)])]),n("img",{src:p.value,alt:"Персонаж",class:Y(["w-48 h-48 object-contain transition-transform duration-300 absolute top-[35%]",{"scale-125":_.value}])},null,10,A),b(N,{name:"score",tag:"div",class:"absolute top-0 left-0 w-full h-full pointer-events-none"},{default:$(()=>[(u(!0),d(j,null,M(s.value,e=>(u(),d("div",{key:e.id,style:k({top:e.top+"px",left:e.left+"px",transform:`translateY(${e.translateY}px)`,opacity:e.opacity}),class:"absolute text-[30px] font-bold text-white"}," +"+v(e.points),5))),128))]),_:1})]))}},J=I(D,[["__scopeId","data-v-edd4c0c5"]]),P={class:"bg-gray-20 overflow-hidden"},E={__name:"index",setup(a){return(c,t)=>(u(),d("div",P,[b(J)]))}};export{E as default};
